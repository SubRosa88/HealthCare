<h2 style="display: flex; justify-content: center;">Histórico Pessoal</h2>
<p-button label="Add Event" icon="pi pi-pencil" (click)="openMedicalEventDialog()" styleClass="p-mt-2"></p-button>
<p-timeline [value]="events">
  <ng-template class="fit-content" pTemplate="content" let-event>
    <p-card [header]="event.title" [subheader]="this.buildSubtitle(event.date, event.subtitle, event.where)">
      <p-accordion [activeIndex]="0">
        <p-accordionTab header="Descrição">
          <p>
            {{event.description}}
          </p>
        </p-accordionTab>
        <p-accordionTab header="Medicação">
          <p-table
          [value]="event?.medication"
          [tableStyle]="{ 'min-width': '50rem' }"
          responsiveLayout="scroll"
        >
          <ng-template pTemplate="header">
            <tr>
              <th>Name</th>
              <th>Dosage</th>
              <th>Frequency</th>
              <th>Instructions</th>
              <th>Start Date</th>
              <th>Duration</th>
              <th style="width: 8rem">Action</th>
            </tr>
          </ng-template>
          <ng-template pTemplate="body" let-medication>
            <tr>
              <td>{{ medication.name }}</td>
              <td>{{ medication.dosage }}</td>
              <td>{{ medication.frequency }}</td>
              <td>{{ medication.start  | date: 'shortDate' }}</td>
              <td>{{ medication.end | date: 'shortDate' }}</td>
              <td>{{ medication.notes }}</td>
              <td>
                <p-button
                  icon="pi pi-trash"
                  styleClass="p-button-danger p-button-sm"
                  (click)="removeMedication(event,medication)"
                  ariaLabel="Remove medication"
                />
              </td>
            </tr>
          </ng-template>
          <ng-template pTemplate="emptymessage">
            <tr>
              <td colspan="7">No medications found.</td>
            </tr>
          </ng-template>
        </p-table>
          <p-button label="Add Medication" icon="pi pi-pencil" (click)="openMedicationDialog(event)" styleClass="p-mt-2"></p-button>
        </p-accordionTab>
        <p-accordionTab header="Notas">
          <p>
            {{event.notes}}
          </p>
        </p-accordionTab>
        <p-accordionTab class="badge-visible" header="Anexos" pBadge value="{{event.files.length}}" badgeSize="large" badgeSeverity="info">
          <p-fileUpload
            mode="basic"
            name="demo[]"
            chooseIcon="pi pi-upload"
            [multiple]="true"
            url="https://www.primefaces.org/cdn/api/upload.php"
            accept="image/*" maxFileSize="1000000"
            (onUpload)="onBasicUploadAuto(event.id, $event)"
            [auto]="true"
            chooseLabel="Browse" />
          <p></p>
          <li *ngFor="let file of event.files; index as i;">{{file.name}}</li>
        </p-accordionTab>
      </p-accordion>
      <p-button label="Read more" [text]="true" />
    </p-card>
  </ng-template>
  <ng-template class="fit-opposite" pTemplate="opposite" let-event>
    {{ event.date | date:'MM/yyyy'}}
  </ng-template>
</p-timeline>
